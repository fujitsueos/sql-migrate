version: 2
jobs:
  build:
    docker:
    - image: golang:1.9
    steps:
    - checkout
    - run:
        name: Install dependencies
        command: |
          go get -v github.com/golang/dep/cmd/dep
          curl -sfL https://install.goreleaser.com/github.com/golangci/golangci-lint.sh | bash -s -- -b /go/bin v1.9.1
          dep ensure -v -vendor-only

    - run:
        name: Lint
        command: golangci-lint run -v

    - run:
        name: Test
        command: go test -race -cover ./...

workflows:
 version: 2
 build:
   jobs:
     - build:
